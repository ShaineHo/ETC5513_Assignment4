---
title: "Research Topic"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: scroll
---

```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(plotly)
library(dplyr)
library(kableExtra)
library(tidytuesdayR)
library(rnaturalearth)
library(gganimate)
library(viridis)
library(sf)
library(RColorBrewer)
library(rgeos)
library(gifski)
```

Introduction {.tabset}
======================

Column {data-width=700}
-----------------------------------------------------------------------

### Chart A

```{r}

```



Column {data-width=300}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Group info

**Team of Thrones**

*Members:*

- *Ambalika Gupta*
- *Smriti Vinayak Bhat*
- *Yin Shan Ho*

Skills {.tabset} 
======================




Talent Migration {.tabset} 
======================




Employment Growth {.tabset} 
======================

Column {data-width=700}
-----------------------------------------------------------------------

### Chart A

```{r}
# import data
emp_growth <- read_csv("../clean_data/emp_growth.csv")
```

```{r}
emp_growth_long <- emp_growth %>% 
  pivot_longer(cols = c("2015":"2019"), names_to = "year", values_to = "growth_rate") %>% 
  select(!c(isic_section_index, industry_id))

emp_growth_long %>% 
  group_by(isic_section_name, industry_name, year) %>% 
  summarise(avg_growth_rate = mean(growth_rate)*100)
```

```{r}

emp_loc <- emp_growth_long %>%
  mutate(country_name = recode(country_name,
                             `Congo, Dem. Rep.` = "Democratic Republic of the Congo",
                             "Dominican Republic" = "Dominica" ,
                             `Egypt, Arab Rep.` = "Egypt" ,
                             `Hong Kong S.A.R.` = "Hong Kong SAR, China", 
                             `Iran, Islamic Rep.` = "Iran",
                             `Korea, Rep.` = "	South Korea",
                             "United States" = "United States of America",
                             "Tanzania" = "United Republic of Tanzania",
                          "Taiwan, China" = "Taiwan",
                          "Venezuela, RB" = "Venezuela",
                          `Yemen, Rep.` = "Yemen"  ,
                          "Serbia" = "Republic of Serbia"  ))

countries <- ne_countries(returnclass = "sf", scale = "medium") %>%
  select(admin)

`full.list.map.time` <- ne_countries(returnclass = "sf", scale = "medium") %>%
  select(admin) %>% 
  full_join(emp_growth_long, by = c("admin" = "country_name")) %>% 
  filter(!is.na(country_code))

emp_map  <- ggplot()+
  geom_sf(data = countries, fill = NA)+
  geom_sf(data = `full.list.map.time` %>% 
            filter(!is.na(year)), mapping = aes(fill = growth_rate))+
  scale_fill_viridis(na.value="white")+
  labs(title = "Change of employment growth rate",
       subtitle = "Year: {current_frame}",
       fill = "Growth_rate")+
  theme_bw()+
  transition_manual(year)


animate(emp_map, duration = 10, fps = 20, width = 1000, height = 500, renderer = gifski_renderer())

```








Column {data-width=300}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```


References {.tabset}
======================

World Bank. (n.d.). Skills | LinkedIn Data | Data Catalog. Retrieved May 17, 2021, from https://datacatalog.worldbank.org/dataset/skills-linkedin-data

World Bank. (n.d.). Employment Growth | LinkedIn Data | Data Catalog. Retrieved May 17, 2021, from https://datacatalog.worldbank.org/dataset/employment-growth-linkedin-data

